<%- include('../partials/head') %>

<div class="page-header">
  <h1>Edit Task</h1>
  <a href="/tasks/<%= task._id %>" class="btn btn-outline">‚Üê Back to Task</a>
</div>

<% if (error) { %>
  <div class="alert alert-error"><%= error %></div>
<% } %>

<div class="form-container">
  <form action="/tasks/<%= task._id %>?_method=PUT" method="POST" class="form">
    <div class="form-group">
      <label for="title">Title *</label>
      <input 
        type="text" 
        id="title" 
        name="title" 
        required 
        maxlength="100"
        value="<%= task.title %>"
      >
    </div>
    
    <div class="form-group">
      <label for="description">Description</label>
      <textarea 
        id="description" 
        name="description" 
        rows="4" 
        maxlength="500"
      ><%= task.description || '' %></textarea>
    </div>
    
    <div class="form-row">
      <div class="form-group">
        <label for="status">Status</label>
        <select id="status" name="status">
          <option value="todo" <%= task.status === 'todo' ? 'selected' : '' %>>To Do</option>
          <option value="in-progress" <%= task.status === 'in-progress' ? 'selected' : '' %>>In Progress</option>
          <option value="done" <%= task.status === 'done' ? 'selected' : '' %>>Done</option>
        </select>
      </div>
      
      <div class="form-group">
        <label for="priority">Priority</label>
        <select id="priority" name="priority">
          <option value="low" <%= task.priority === 'low' ? 'selected' : '' %>>Low</option>
          <option value="medium" <%= task.priority === 'medium' ? 'selected' : '' %>>Medium</option>
          <option value="high" <%= task.priority === 'high' ? 'selected' : '' %>>High</option>
        </select>
      </div>
    </div>
    
    <div class="form-row">
      <div class="form-group">
        <label for="dueDate">Due Date</label>
        <input 
          type="date" 
          id="dueDate" 
          name="dueDate"
          value="<%= task.dueDate ? new Date(task.dueDate).toISOString().split('T')[0] : '' %>"
        >
      </div>
      
      <div class="form-group">
        <label for="categoryId">Category</label>
        <select id="categoryId" name="categoryId">
          <option value="">No Category</option>
          <% categories.forEach(cat => { %>
            <option value="<%= cat._id %>" <%= task.categoryId && task.categoryId.toString() === cat._id.toString() ? 'selected' : '' %>><%= cat.name %></option>
          <% }) %>
        </select>
      </div>
    </div>
    
    <div class="form-actions">
      <button type="submit" class="btn btn-primary">Update Task</button>
      <a href="/tasks/<%= task._id %>" class="btn btn-outline">Cancel</a>
    </div>
  </form>
</div>

<%- include('../partials/footer') %>